# sql_pizza_sales_project

###project overview 
###project title : pizza_sales
###level : beginner
###Database: p1_sales_db


This repository contains a set of SQL queries designed for analyzing data related to pizza orders. The queries are intended to provide valuable insights such as the total number of orders, total revenue, most ordered pizza types, and more. This README outlines each SQL query and its intended purpose.

### Objectives
1.Set up a pizza sales database: Create and populate a pizza sales database with the provided sales data.
2.Data Cleaning: Identify and remove any records with missing or null values.
3.Exploratory Data Analysis (EDA): Perform basic exploratory data analysis to understand the dataset.
4.Business Analysis: Use SQL to answer specific business questions and derive insights from the sales data.

## Queries Overview

### 1. Retrieve the Total Number of Orders Placed
This query calculates the total number of orders placed by counting the number of `order_id` entries in the `orders` table.

```sql
SELECT COUNT(order_id) AS total_order_placed
FROM orders;

### 2. Calculate the Total Revenue Generated from Pizza SalesThis query calculates the total revenue generated by multiplying the price of each pizza by its ordered quantity.

This query calculates the total revenue generated by multiplying the price of each pizza by its ordered quantity.

```sql
SELECT SUM(pizzas.price * order_details.quantity) AS total_revenue
FROM pizzas
JOIN order_details
ON pizzas.pizza_id = order_details.pizza_id;```

### 3. Identify the Highest-Priced Pizza
This query returns the highest-priced pizza from the database by ordering pizzas by price in descending order and limiting the result to one.

```sql
SELECT pizza_types.name, pizzas.price
FROM pizza_types
JOIN pizzas
ON pizza_types.pizza_type_id = pizzas.pizza_type_id
ORDER BY pizzas.price DESC
LIMIT 1;
```
### 4. Identify the Most Common Pizza Size Ordered
This query identifies the most common pizza size ordered, based on the frequency of orders for each pizza size.

```sql
SELECT COUNT(order_details.order_id) AS ordered, pizzas.size
FROM order_details
JOIN pizzas
ON pizzas.pizza_id = order_details.pizza_id
GROUP BY pizzas.size
ORDER BY ordered DESC;
```
### 5. List the Top 5 Most Ordered Pizza Types Along with Their Quantities
This query retrieves the top 5 most ordered pizza types and their respective total quantities.

```sql
SELECT pizza_types.name, SUM(order_details.quantity) AS total_quantity
FROM pizza_types
JOIN pizzas
ON pizzas.pizza_type_id = pizza_types.pizza_type_id
JOIN order_details
ON pizzas.pizza_id = order_details.pizza_id
GROUP BY pizza_types.name
ORDER BY total_quantity DESC
LIMIT 5;
```
'

### 6. Total Quantity of Each Pizza Category Ordered
This query calculates the total quantity of each pizza category ordered by joining relevant tables and grouping by `pizza_types.category`.

```sql
SELECT pizza_types.category, SUM(order_details.quantity) AS quantity
FROM pizza_types
JOIN pizzas
ON pizzas.pizza_type_id = pizza_types.pizza_type_id
JOIN order_details
ON order_details.pizza_id = pizzas.pizza_id
GROUP BY pizza_types.category
ORDER BY quantity DESC;
```
### 7. Distribution of Orders by Hour of the Day
This query determines the distribution of pizza orders by hour of the day.

```sql
SELECT EXTRACT(HOUR FROM orders.time) AS order_time, COUNT(order_id) AS order_per_day
FROM orders
GROUP BY order_time
ORDER BY order_time;
```
### 8. Category-Wise Distribution of Pizzas
This query provides the category-wise distribution of pizzas, counting the number of pizzas in each category.

```sql
SELECT category, COUNT(name)
FROM pizza_types
GROUP BY category;
```
### 9. Average Number of Pizzas Ordered Per Day
This query calculates the average number of pizzas ordered per day by grouping orders by date and summing up the total quantity of pizzas ordered.

```sql
SELECT ROUND(AVG(per_day_order), 2)
FROM 
    (SELECT orders.date, SUM(order_details.quantity) AS per_day_order
     FROM orders 
     JOIN order_details
     ON orders.order_id = order_details.order_id
     GROUP BY orders.date) AS a;
```
### 10. Top 3 Most Ordered Pizza Types Based on Revenue
This query identifies the top 3 most ordered pizza types based on total revenue, which is calculated by multiplying quantity ordered by pizza price.

```sql
SELECT pizza_types.name, ROUND(SUM(order_details.quantity * pizzas.price), 2) AS pizza_revenue
FROM pizza_types
JOIN pizzas
ON pizza_types.pizza_type_id = pizzas.pizza_type_id
JOIN order_details
ON order_details.pizza_id = pizzas.pizza_id
GROUP BY pizza_types.name
ORDER BY pizza_revenue DESC
LIMIT 3;
```
### 11. Percentage Contribution of Each Pizza Type to Total Revenue
This query calculates the percentage revenue contribution of each pizza type to the total revenue.

```sql
SELECT pizza_types.category,
      ROUND(SUM(order_details.quantity * pizzas.price) / 
           (SELECT ROUND(SUM(order_details.quantity * pizzas.price), 2) AS total_revenue
            FROM order_details JOIN pizzas
            ON order_details.pizza_id = pizzas.pizza_id) * 100, 2) AS revenue
FROM pizza_types 
JOIN pizzas
  ON pizza_types.pizza_type_id = pizzas.pizza_type_id
JOIN order_details
ON order_details.pizza_id = pizzas.pizza_id
GROUP BY pizza_types.category
ORDER BY revenue DESC;
```
### 12. Cumulative Revenue Generated Over Time
This query computes the cumulative revenue over time, by using a window function to sum the daily revenue.

```sql
SELECT order_date, 
       SUM(revenue) OVER(ORDER BY order_date) AS cum_revenue
FROM
    (SELECT orders.date AS order_date, 
            SUM(order_details.quantity * pizzas.price) AS revenue
     FROM order_details
     JOIN pizzas
     ON order_details.pizza_id = pizzas.pizza_id
     JOIN orders 
     ON orders.order_id = order_details.order_id
     GROUP BY orders.date) AS sales;
```

### 13. Top 3 Most Ordered Pizza Types Based on Revenue for Each Pizza Category
This query identifies the top 3 most ordered pizza types based on revenue for each pizza category, using the `RANK()` window function.

```sql
SELECT name, category, revenue
FROM 
    (SELECT category, name, revenue,
            RANK() OVER (PARTITION BY category ORDER BY revenue DESC) AS rn
     FROM
         (SELECT pizza_types.category,
                 pizza_types.name,
                 SUM(order_details.quantity * pizzas.price) AS revenue
          FROM pizza_types
          JOIN pizzas
          ON pizza_types.pizza_type_id = pizzas.pizza_type_id
          JOIN order_details
          ON order_details.pizza_id = pizzas.pizza_id
          GROUP BY pizza_types.category, pizza_types.name) AS a) AS b
WHERE rn <= 3;
```

## Requirements

- A relational database (such as MySQL, PostgreSQL, or SQLite) with the following tables:
  - `orders`
  - `order_details`
  - `pizzas`
  - `pizza_types`
  
- The database should contain data relevant to pizza orders, including order details, pizza prices, pizza types, and categories.

---
Reports
Sales Summary: A detailed report summarizing total sales, customer demographics, and category performance.
Trend Analysis: Insights into sales trends across different months and shifts.
Customer Insights: Reports on top customers and unique customer counts per category.

### Conclusion
This project serves as a comprehensive introduction to SQL for data analysts, covering database setup, data cleaning, exploratory data analysis, and business-driven SQL queries. The findings from this project can help drive business decisions by understanding sales patterns, customer behavior, and product performance.

### Author - amit wankhade
This project is part of my portfolio, showcasing the SQL skills essential for data analyst roles. If you have any questions, feedback, or would like to collaborate, feel free to get in touch! 10. Top 3 Most Ordered Pizza Types Based on Revenue
This query identifies the top 3 most ordered pizza types based on total revenue, which is calculated by multiplying quantity ordered by pizza price.






